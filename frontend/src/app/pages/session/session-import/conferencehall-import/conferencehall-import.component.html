<section class="conferencehall-import">
  <p-confirmdialog></p-confirmdialog>
  <h3>{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.TITLE' | translate }}</h3>

  <div class="meta-row">
    <span class="label">{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.LAST_IMPORT' | translate }}</span>
    <span>
      @if (lastImportAt()) {
      {{ lastImportAt() | date : 'dd/MM/yyyy HH:mm:ss' }}
      } @else {
      {{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.NEVER' | translate }}
      }
    </span>
  </div>

  <div class="actions-row">
    <button
      pButton
      type="button"
      [label]="'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.BUTTON' | translate"
      icon="pi pi-download"
      [loading]="importLoading()"
      [disabled]="loading()"
      (click)="runImport()"
    ></button>
    <button
      pButton
      type="button"
      severity="danger"
      [label]="'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.RESET_BUTTON' | translate"
      icon="pi pi-trash"
      [loading]="resetLoading()"
      [disabled]="loading()"
      (click)="runReset()"
    ></button>
  </div>

  @if (error()) {
  <div class="error-box">{{ error() }}</div>
  }

  @if (report(); as result) {
  <div class="report-box">
    <h4>{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.REPORT' | translate }}</h4>
    <div class="meta-row">
      <span class="label">{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.IMPORTED_AT' | translate }}</span>
      <span>{{ result.importedAt | date : 'dd/MM/yyyy HH:mm:ss' }}</span>
    </div>
    <div class="meta-row">
      <span class="label">{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.EXECUTION_TIME' | translate }}</span>
      <span>{{ importExecutionTimeSeconds() | number : '1.2-2' }} s</span>
    </div>
    <table class="report-table">
      <thead>
        <tr>
          <th>{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.DATA_TYPE' | translate }}</th>
          <th>{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.ADDED' | translate }}</th>
          <th>{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.UPDATED' | translate }}</th>
          <th>{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.UNCHANGED' | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.SESSION' | translate }}</td>
          <td>{{ result.sessionAdded }}</td>
          <td>{{ result.sessionUpdated }}</td>
          <td>{{ result.sessionUnchanged }}</td>
        </tr>
        <tr>
          <td>{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.SPEAKER' | translate }}</td>
          <td>{{ result.speakerAdded }}</td>
          <td>{{ result.speakerUpdated }}</td>
          <td>{{ result.speakerUnchanged }}</td>
        </tr>
        <tr>
          <td>{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.TRACK' | translate }}</td>
          <td>{{ result.trackAdded }}</td>
          <td>{{ result.trackUpdated }}</td>
          <td>{{ result.trackUnchanged }}</td>
        </tr>
      </tbody>
    </table>
  </div>
  }

  @if (resetReport(); as reset) {
  <div class="report-box">
    <h4>{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.RESET_REPORT' | translate }}</h4>
    <div class="meta-row">
      <span class="label">{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.RESET_AT' | translate }}</span>
      <span>{{ reset.resetAt | date : 'dd/MM/yyyy HH:mm:ss' }}</span>
    </div>
    <div class="meta-row">
      <span class="label">{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.EXECUTION_TIME' | translate }}</span>
      <span>{{ resetExecutionTimeSeconds() | number : '1.2-2' }} s</span>
    </div>
    <div class="meta-row">
      <span class="label">{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.SESSION_DELETED' | translate }}</span>
      <span>{{ reset.sessionDeleted }}</span>
    </div>
    <div class="meta-row">
      <span class="label">{{ 'CONFERENCE.CONFIG.CONFERENCEHALL.IMPORT.SPEAKER_DELETED' | translate }}</span>
      <span>{{ reset.speakerDeleted }}</span>
    </div>
  </div>
  }
</section>

