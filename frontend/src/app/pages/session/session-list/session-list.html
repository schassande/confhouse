<h2 class="page-title">
  @if (conferenceName()) {
  {{ 'SESSION.LIST.PAGE_TITLE' | translate : { conference: conferenceName() } }}
  } @else {
  {{ 'SESSION.LIST.TITLE' | translate }}
  }
</h2>

<p-dataview
  class="session-dataview"
  [value]="filteredSortedSessions()"
  [paginator]="true"
  [rows]="20"
  layout="list"
  [loading]="loading()"
  [showCurrentPageReport]="true"
  currentPageReportTemplate="{first} - {last} / {totalRecords}"
>
  <ng-template #header>
    <div class="session-list-toolbar">
      <div class="toolbar-row filters-row">
        <p-multiselect
          [options]="sessionTypeOptions()"
          [ngModel]="selectedSessionTypeIds()"
          (ngModelChange)="selectedSessionTypeIds.set($event)"
          optionLabel="label"
          optionValue="value"
          display="chip"
          [showToggleAll]="false"
          [placeholder]="'SESSION.LIST.FILTER_SESSION_TYPE' | translate"
          class="header-control"
        ></p-multiselect>

        <p-multiselect
          [options]="trackOptions()"
          [ngModel]="selectedTrackIds()"
          (ngModelChange)="selectedTrackIds.set($event)"
          optionLabel="label"
          optionValue="value"
          display="chip"
          [showToggleAll]="false"
          [placeholder]="'SESSION.LIST.FILTER_TRACK' | translate"
          class="header-control"
        ></p-multiselect>

        <p-multiselect
          [options]="statusOptions()"
          [ngModel]="selectedStatuses()"
          (ngModelChange)="selectedStatuses.set($event)"
          optionLabel="label"
          optionValue="value"
          display="chip"
          [showToggleAll]="false"
          [placeholder]="'SESSION.LIST.FILTER_STATUS' | translate"
          class="header-control"
        ></p-multiselect>
      </div>

      <div class="toolbar-row search-sort-row">
        <input
          pInputText
          type="text"
          [ngModel]="searchText()"
          (ngModelChange)="searchText.set($event)"
          [placeholder]="'SESSION.LIST.SEARCH_PLACEHOLDER' | translate"
          class="header-control header-search"
        />

        <p-select
          [options]="sortOptions()"
          [ngModel]="sortBy()"
          (ngModelChange)="sortBy.set($event)"
          optionLabel="label"
          optionValue="value"
          [placeholder]="'SESSION.LIST.SORT_BY' | translate"
          class="header-control"
        ></p-select>
      </div>

      <div class="toolbar-row count-row">
      <div class="session-count">
        {{
          'SESSION.LIST.COUNT'
            | translate
              : {
                  filtered: filteredSortedSessions().length,
                  total: sessionsForView().length
                }
        }}
      </div>
      </div>
    </div>
  </ng-template>

  <ng-template #list let-items>
    <div class="session-list">
      @for (item of items; track item.session.id) {
      <div class="session-card">
        <div class="line-1">
          <div class="session-title">{{ item.session.title }}</div>
          <p-tag
            [value]="item.session.conference?.status ?? ''"
            [severity]="item.statusSeverity"
          ></p-tag>
        </div>

        <div class="line-2">
          <div class="speakers">{{ item.speakerNames.join(', ') }}</div>
          <div class="meta">
            <p-tag
              [value]="item.sessionTypeName"
              [style]="{
                'background-color': item.sessionTypeColor,
                color: item.sessionTypeTextColor,
                border: 'none'
              }"
            ></p-tag>
            <p-tag
              [value]="item.trackName"
              [style]="{
                'background-color': item.trackColor,
                color: item.trackTextColor,
                border: 'none'
              }"
            ></p-tag>
            @if (item.session.level) {
              <p-tag [value]="item.session.level" severity="info"></p-tag>
            }
          </div>
        </div>
      </div>
      }
    </div>
  </ng-template>

  <ng-template #emptymessage>
    <div class="empty-message">{{ 'SESSION.LIST.EMPTY' | translate }}</div>
  </ng-template>
</p-dataview>
